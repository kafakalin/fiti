<!DOCTYPE html>
<html lang="en" class="layout-html">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>版型設計</title>
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/simplebar.css">
    <link rel="stylesheet" href="css/dropzone.css">
    <link rel="stylesheet" href="css/dropkick.css">
    <link rel="stylesheet" href="css/fiti.css">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon"/>
</head>
<body class="layout-body">

<div class="layout-box">

    <div class="layout-input">
        <form action="">
            <section class="layout-input-group">
                <div class="input-title">
                    STEP 1.<br><span>建立範本資料</span>
                </div>
                <div class="form-group input-form-group">
                    <label for="filed1">範本名稱：</label>
                    <input type="text" class="form-control" id="filed1" placeholder="請輸入範本名稱">
                </div>
                <div class="form-group input-form-group">
                    <label for="filed2">範本摘要：</label>
                    <input type="text" class="form-control" id="filed2" placeholder="請輸入範本摘要">
                </div>
            </section>

            <section>
                <div class="input-title">
                    STEP 2.<br><span>選擇範本版型</span>
                </div>
                <div class="layout-selector">
                    <div class="row no-gutters">
                        <div class="col"><a class="layoutA-trigger layout-trigger" data-link="" href="#"><img src="img/Layout_A.png" alt="" class="img-fluid"><span>Style A</span></a></div>
                        <div class="col"><a class="layoutB-trigger layout-trigger" data-link="group-b" href="#"><img src="img/Layout_B.png" alt="" class="img-fluid"><span>Style B</span></a></div>
                        <div class="col"><a class="layoutC-trigger layout-trigger" data-link="group-c" href="#"><img src="img/Layout_C.png" alt="" class="img-fluid"><span>Style C</span></a></div>
                        <div class="col"><a class="layoutD-trigger layout-trigger" data-link="group-d" href="#"><img src="img/Layout_D.png" alt="" class="img-fluid"><span>Style D</span></a></div>
                        <div class="col"><a class="layoutE-trigger layout-trigger" data-link="group-e" href="#"><img src="img/Layout_E.png" alt="" class="img-fluid"><span>Style E</span></a></div>
                        <div class="col"><a class="layoutF-trigger layout-trigger" data-link="group-f" href="#"><img src="img/Layout_F.png" alt="" class="img-fluid"><span>Style F</span></a></div>
                        <div class="col"><a class="layoutG-trigger layout-trigger" data-link="group-g" href="#"><img src="img/Layout_G.png" alt="" class="img-fluid"><span>Style G</span></a></div>
                        <div class="col"><a class="layoutH-trigger layout-trigger active" data-link="group-h" href="#"><img src="img/Layout_H.png" alt="" class="img-fluid"><span>Style H</span></a></div>
                    </div>
                </div>
                <div class="img-link-setting">
                    <div class="row">
                        <div class="col-5">
                            <div class="form-group input-form-group">
                                <div class="dropzone" id="dropzone" style='display:none'><div class="dz-default dz-message"><span>Drop files here to upload</span></div></div>
                                <label for="filed3">圖檔上傳：</label>
                                <div class="input-img-upload">
                                    <img src="img/upload-preview.jpg" alt="" class="img-fluid preview" />
                                </div>
                                <input type="file" class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;">
                            </div>

                            <div class="form-group input-form-group">
                                <label for="filed4">圖檔網址：</label>
                                <input type="text" class="form-control url" placeholder="https://">
                            </div>
                        </div>
                        <div class="col-7">
                            <div class="form-group input-form-group">
                                <label for="">連結設定：</label>
                                <div class="group-b link-group">
                                    <div class="link-input">
                                        <img src="img/B1.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                </div>
                                <div class="group-c link-group">
                                    <div class="link-input">
                                        <img src="img/C1.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/C2.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                </div>
                                <div class="group-d link-group">
                                    <div class="link-input">
                                        <img src="img/D1.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/D2.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                </div>
                                <div class="group-e link-group">
                                    <div class="link-input">
                                        <img src="img/E1.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/E2.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/E3.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                </div>
                                <div class="group-f link-group">
                                    <div class="link-input">
                                        <img src="img/F1.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/F2.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/F3.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/F4.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                </div>
                                <div class="group-g link-group">
                                    <div class="link-input">
                                        <img src="img/G1.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/G2.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/G3.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/G4.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                </div>
                                <div class="group-h link-group active">
                                    <div class="link-input">
                                        <img src="img/H1.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/H2.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/H3.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/H4.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/H5.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                    <div class="link-input">
                                        <img src="img/H6.png" alt="">
                                        <input type="text" class="form-control url" placeholder="https://">
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </section>

            <section class="step3">
                <div class="input-title">
                    STEP 3.<br><span>編輯訊息內容</span>
                </div>
                <div class="form-group input-form-group" id='paragraph'>
                    <div class="row">
                        <div class="col-3">
                            <select name="" id="layout-type">
                                <option value="">文字在前</option>
                                <option value="img-first">文字在後</option>
                                <option value="no-text">沒有文字</option>
                            </select>
                        </div>
                    </div>
                    <div class="input-text-content-box">
                        <input type="text" class="form-control" placeholder="請輸入文字內容">
                        <div class="input-text-content-box-control">
                            <a href="#" class='minus'><img src="img/minus.png" alt=""></a>
                            <a href="#" class='plus'><img src="img/plus.png" alt=""></a>
                        </div>
                    </div>
                    <div class="input-text-content-box">
                        <input type="text" class="form-control" placeholder="請輸入文字內容">
                        <div class="input-text-content-box-control">
                            <a href="#" class='minus'><img src="img/minus.png" alt=""></a>
                            <a href="#" class='plus'><img src="img/plus.png" alt=""></a>
                        </div>
                    </div>
                </div>
                <div class="form-group input-form-group">
                    <label for="" class="mb-3">參數小工具：</label>
                    <div class="row align-items-start">
                        <div class="col-3">
                            <select name="" id="name-selector">
                                <option value="">姓氏</option>
                                <option value="">姓名</option>
                            </select>
                        </div>
                        <div class="col-4">
                            <div class="shortcode-box">
                                <input id="shortCode" type="text" class="form-control" placeholder="" value="{!LastName}">
                                <small>請複製貼上到上方文字中你想要的位置即可</small>
                                <a href="#" class="copy-text">複製</a>
                            </div>

                        </div>
                        <div class="col-5 text-right">
                            <div class="save-btns">
                                <a href="#" class="btn btn-white">取消</a>
                                <a href="#" class="btn btn-white">儲存設定</a>
                            </div>

                        </div>
                    </div>
                </div>

            </section>

        </form>
    </div>
    <div class="layout-preview">
        <h3>Preview</h3>
        <div class="layout-preview-phone">
            <div class="layout-preview-phone-content">
                <div class="layout-preview-phone-content-inside">
                    <div class="preview-text">

                        <div class="message-box-content">
                            <div class="message-box-messages" id="message-box-messages">
                                <div class="message-group user-message">
                                    <div class="messages">
                                        <div class="user-name">Kevin Chen</div>
                                        <div class="message-item">
                                            <div class="message-item-inside">您所輸入的訊息文字將會顯示在這邊！</div>
                                        </div>

                                        <div class="message-item">
                                            <div class="message-item-inside" id='sample'></div>
                                        </div>
                                    </div>
                                    <div class="profile">
                                        <img src="img/user_pic.png" alt="">
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                    <div class="preview-img">
                        <img src="img/preview-img-sample.jpg" alt="" class="preview">
                    </div>
                </div>
            </div>
            <div class="layout-preview-phone-bg">
                <img src="img/preview-iphone.png" alt="">
            </div>
        </div>
    </div>
</div>

<script src="js/jquery-3.3.1.slim.min.js"></script>
<script src="js/popper.min.js"></script>
<script src="js/bootstrap.js"></script>
<script src="js/dropkick.js"></script>
<script>
    $(function() {
        $("#layout-type").dropkick({
            mobile: true,
            change: function (value) {
                value = this.value;
                $('.layout-preview-phone-content-inside').removeClass('img-first no-text').addClass(value);
            }
        });
        $("#name-selector").dropkick({
            mobile: true
        });

        $(".copy-text").on('click',function(e){
            e.preventDefault();
            var copyText = $("#shortCode");
            copyText.select();
            document.execCommand("Copy");
            alert('已複製代碼');
        })

        $(".input-img-upload").on("click", function(e) {
            e.stopPropagation();
            e.preventDefault();
            $(".dz-hidden-input").trigger("click");
        });

        $(".dz-hidden-input").on("change", function(e){
            if (!/^$/i.test($(this).val())) {
                var fd = new FormData();
                var files = $('.dz-hidden-input')[0].files[0];
                fd.append('file',files);
                readURL($('.dz-hidden-input')[0]);   
            }
        });

        $(".img-link-setting").on("keyup", "input.url", function(e) {
            var value = $(this).val();
            $(this).parent().find("label.error").remove();
            if (!isURL(value)) {
                $(this).after("<label class='error'>網址錯誤</label>");
            }
            e.stopPropagation();
        });

        $("#dropzone").on("dragenter", function(e) {
            e.stopPropagation();
            e.preventDefault();
            $("#dropzone").show();
            $("#dropzone").addClass("dragenter");
        });

        $("#dropzone").on("dragover", function(e) {
            e.stopPropagation();
            e.preventDefault();
            $("#dropzone").show();
            if (!$("#dropzone").hasClass("dragenter")) {
                $("#dropzone").addClass("dragenter");
            }
        });

        $("#dropzone").on("dragleave", function(e) {
            e.stopPropagation();
            e.preventDefault();
            $("#dropzone").show();
            if ($("#dropzone").hasClass("dragenter")) {
                $("#dropzone").removeClass("dragenter");
            }
        });

        $('html').on('dragover', function (e) {
            e.stopPropagation();
            e.preventDefault();
            $("#dropzone").show();
        });

        $('html').on('dragleave', function(e) {
            e.stopPropagation();
            e.preventDefault();
            if (!$("#dropzone").hasClass("dragenter")) {
                $("#dropzone").hide();
            }
        });

        $('html').on("drop", function(e) {
            e.preventDefault();
            e.stopPropagation();
            resetDropZone();
        });

        $("#dropzone").on("drop", function(e) {
            e.stopPropagation();
            e.preventDefault();
            
            readURL(e.originalEvent.dataTransfer);
            resetDropZone();
        });

        $('.layout-trigger').on('click',function(e){
            e.preventDefault();
            var actionLink = $(this).data('link');
            $('.layout-trigger').removeClass('active');
            $(this).addClass('active');
            $('.link-group').removeClass('active');
            $('.'+actionLink).addClass('active');
        })

        moreParagraph();
    });

    function moreParagraph() {
        $("#paragraph").off("click", "a.minus").on("click", "a.minus", function(e) {
            e.preventDefault();
            $(this).parents(".input-text-content-box:first").remove();
            getContent();
        });

        $("#paragraph").off("click", "a.plus").on("click", "a.plus", function(e) {
            e.preventDefault();
            var obj = $("#paragraph").find(".input-text-content-box:last").clone();
            $(obj).find(":input").val("");
            $(obj).appendTo($("#paragraph"));
            moreParagraph();
        });

        $("#paragraph").off("keyup", "input:text").on("keyup", "input:text", function(e) {
            getContent();
        });

        hiddenMinus();
    }

    function hiddenMinus() {
        $("#paragraph").find("a.minus").show();
        $("#paragraph").find(".input-text-content-box:first a.minus").hide();
    }

    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function(e) {
                $('img.preview').attr('src', e.target.result);
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    function isURL(url) {
        var pattern = /(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;
        return pattern.test(url);
    }

    function resetDropZone() {
        $("#dropzone").hide();
        $("#dropzone").removeClass("dragenter");
    }

    function getContent() {
        var html = [];
        $("#paragraph").find("input:text").each(function(i) {
            if (!/^\s*$/.test($(this).val())) {
                html.push($(this).val());
            }
        });
        $("#sample").html(html.length>0?html.join('<br><br>'):"");
    }
</script>

</body>
</html>